
module ol_vamp_15_ppllnnjj_vbs_nenmexmxuxuxdd_2_/**/REALKIND
  use KIND_TYPES, only: REALKIND
  implicit none

  contains

! **********************************************************************
subroutine vamp_15(M, mode, hel)
! P(0:3,nlegs) = incoming external momenta
! Uses tree structures 'wf', factors 'c', and denominators 'den' from loop_ppllnnjj_vbs_nenmexmxuxuxdd_2.
! Sets colour stripped amplitudes A from the module loop_amplitudes_ppllnnjj_vbs_nenmexmxuxuxdd_2.
! **********************************************************************
  use ol_momenta_decl_/**/REALKIND, only: Q
  use ol_parameters_decl_/**/REALKIND ! masses
  use ol_loop_parameters_decl_/**/DREALKIND, only: stability_mode
#ifndef PRECISION_dp
  use ol_parameters_decl_/**/DREALKIND, only: l_switch
#endif
  use ol_loop_ppllnnjj_vbs_nenmexmxuxuxdd_2_/**/REALKIND, only: c, f, wf, den
  use ol_vert_interface_/**/REALKIND
  use ol_prop_interface_/**/REALKIND
  use ol_last_step_/**/REALKIND
  use ol_tensor_sum_storage_ppllnnjj_vbs_nenmexmxuxuxdd_2_/**/REALKIND
  use ol_loop_routines_/**/REALKIND, only: G0initialisation, TI2_call
  implicit none

  complex(REALKIND) :: Gcoeff
  complex(REALKIND), intent(in) :: M(4)
  integer, intent(in) :: mode, hel ! recycle mode & hel conf number

  ! Declarations of loop wave function tensors
  complex(REALKIND), dimension(4,1,4,1) :: G0
  complex(REALKIND), dimension(4,5,4,57) :: G1
  complex(REALKIND), dimension(4,15,4,78) :: G2
  complex(REALKIND), dimension(4,35,4,28) :: G3
  complex(REALKIND), dimension(5,10) :: G1tensor
  complex(REALKIND), dimension(15,43) :: G2tensor
  complex(REALKIND), dimension(35,28) :: G3tensor
  complex(REALKIND), dimension(70,3) :: G4tensor
if (mode == -1) return

  if (mode == 1 .or. stability_mode < 20 .or. stability_mode >= 30) then

  call G0initialisation(G0(:,:,:,1))

  ! Vertex and propagator calls to build loop structures
  call loop_UV_W(G0(:,:,:,1),Q(:,0),wf(:,7),Q(:,96),G1(:,:,:,1))
  call loop_VWW_V(G1(:,:,:,1),wf(:,2),wf(:,6),G1(:,:,:,2))
  call check_last_UV_W(l_switch,G1(:,:,:,2),Q(:,250),wf(:,1),Q(:,5),G2tensor(:,1))
  call loop_VWW_V(G1(:,:,:,1),wf(:,1),wf(:,6),G1(:,:,:,3))
  call check_last_UV_W(l_switch,G1(:,:,:,3),Q(:,245),wf(:,2),Q(:,10),G2tensor(:,2))
  call loop_UW_V(G1(:,:,:,1),Q(:,96),wf(:,6),Q(:,144),G2(:,:,:,1))
  call check_last_VWW_V(l_switch,G2(:,:,:,1),wf(:,1),wf(:,2),G2tensor(:,3))
  call loop_ZA_Q(G1(:,:,:,1),wf(:,-4),G1(:,:,:,4),gZu)
  call loop_A_Q(G1(:,:,:,4),Q(:,112),ZERO,G2(:,:,:,2))
  call loop_AQ_W(G2(:,:,:,2),wf(:,-7),G2(:,:,:,3))
  call check_last_VWW_V(l_switch,G2(:,:,:,3),wf(:,1),wf(:,2),G2tensor(:,4))
  call loop_AQ_Z(G2(:,:,:,2),wf(:,27),G2(:,:,:,4),gZu)
  call check_last_UV_W(l_switch,G2(:,:,:,4),Q(:,245),wf(:,2),Q(:,10),G3tensor(:,1))
  call loop_AQ_Z(G2(:,:,:,2),wf(:,20),G2(:,:,:,5),gZu)
  call check_last_UV_W(l_switch,G2(:,:,:,5),Q(:,250),wf(:,1),Q(:,5),G3tensor(:,2))
  call loop_AW_Q(G2(:,:,:,2),wf(:,2),G2(:,:,:,6))
  call loop_A_Q(G2(:,:,:,6),Q(:,122),ZERO,G3(:,:,:,1))
  call loop_AQ_Z(G3(:,:,:,1),wf(:,-7),G3(:,:,:,2),gZd)
  call check_last_UV_W(l_switch,G3(:,:,:,2),Q(:,250),wf(:,1),Q(:,5),G4tensor(:,1))
  call loop_VS_V(G1(:,:,:,1),wf(:,35),G1(:,:,:,5))
  call check_last_UV_W(l_switch,G1(:,:,:,5),Q(:,245),wf(:,2),Q(:,10),G2tensor(:,5))
  call loop_VV_S(G1(:,:,:,1),wf(:,37),G1(:,:,:,6))
  call check_last_SV_V(l_switch,G1(:,:,:,6),wf(:,2),G1tensor(:,1))
  call loop_VS_V(G1(:,:,:,1),wf(:,40),G1(:,:,:,7))
  call check_last_UV_W(l_switch,G1(:,:,:,7),Q(:,250),wf(:,1),Q(:,5),G2tensor(:,6))
  call loop_VV_S(G1(:,:,:,1),wf(:,42),G1(:,:,:,8))
  call check_last_SV_V(l_switch,G1(:,:,:,8),wf(:,1),G1tensor(:,2))
  call loop_UV_W(G1(:,:,:,1),Q(:,96),wf(:,2),Q(:,10),G2(:,:,:,7))
  call loop_UV_W(G2(:,:,:,7),Q(:,106),wf(:,6),Q(:,144),G3(:,:,:,3))
  call check_last_UV_W(l_switch,G3(:,:,:,3),Q(:,250),wf(:,1),Q(:,5),G4tensor(:,2))
  call loop_VV_S(G2(:,:,:,7),wf(:,6),G2(:,:,:,8))
  call check_last_SV_V(l_switch,G2(:,:,:,8),wf(:,1),G2tensor(:,7))
  call loop_WA_Q(G2(:,:,:,7),wf(:,-4),G2(:,:,:,9))
  call loop_A_Q(G2(:,:,:,9),Q(:,122),ZERO,G3(:,:,:,4))
  call loop_AQ_Z(G3(:,:,:,4),wf(:,-7),G3(:,:,:,5),gZd)
  call check_last_UV_W(l_switch,G3(:,:,:,5),Q(:,250),wf(:,1),Q(:,5),G4tensor(:,3))
  call loop_WQ_A(G2(:,:,:,7),wf(:,130),G2(:,:,:,10))
  call loop_Q_A(G2(:,:,:,10),Q(:,251),ZERO,G3(:,:,:,6))
  call check_last_QA_W(l_switch,G3(:,:,:,6),wf(:,-2),G3tensor(:,3))
  call loop_WA_Q(G2(:,:,:,7),wf(:,138),G2(:,:,:,11))
  call loop_A_Q(G2(:,:,:,11),Q(:,254),ZERO,G3(:,:,:,7))
  call check_last_AQ_W(l_switch,G3(:,:,:,7),wf(:,0),G3tensor(:,4))
  call loop_VV_S(G1(:,:,:,1),wf(:,2),G1(:,:,:,9))
  call loop_SV_T(G1(:,:,:,9),Q(:,106),wf(:,6),Q(:,144),G2(:,:,:,12))
  call check_last_SV_V(l_switch,G2(:,:,:,12),wf(:,1),G2tensor(:,8))
  call loop_SV_V(G1(:,:,:,9),wf(:,6),G1(:,:,:,10))
  call check_last_UV_W(l_switch,G1(:,:,:,10),Q(:,250),wf(:,1),Q(:,5),G2tensor(:,9))
  call loop_ZQ_A(G1(:,:,:,1),wf(:,20),G1(:,:,:,11),gZu)
  call loop_Q_A(G1(:,:,:,11),Q(:,234),ZERO,G2(:,:,:,13))
  call check_last_QA_W(l_switch,G2(:,:,:,13),wf(:,44),G2tensor(:,10))
  call loop_VV_S(G1(:,:,:,1),wf(:,47),G1(:,:,:,12))
  call check_last_SV_V(l_switch,G1(:,:,:,12),wf(:,2),G1tensor(:,3))
  call loop_ZA_Q(G1(:,:,:,1),wf(:,44),G1(:,:,:,13),gZd)
  call loop_A_Q(G1(:,:,:,13),Q(:,117),ZERO,G2(:,:,:,14))
  call loop_AQ_Z(G2(:,:,:,14),wf(:,-7),G2(:,:,:,15),gZd)
  call check_last_UV_W(l_switch,G2(:,:,:,15),Q(:,245),wf(:,2),Q(:,10),G3tensor(:,5))
  call loop_ZQ_A(G1(:,:,:,1),wf(:,27),G1(:,:,:,14),gZu)
  call loop_Q_A(G1(:,:,:,14),Q(:,229),ZERO,G2(:,:,:,16))
  call check_last_QA_W(l_switch,G2(:,:,:,16),wf(:,49),G2tensor(:,11))
  call loop_VV_S(G1(:,:,:,1),wf(:,52),G1(:,:,:,15))
  call check_last_SV_V(l_switch,G1(:,:,:,15),wf(:,2),G1tensor(:,4))
  call loop_VV_S(G1(:,:,:,1),wf(:,54),G1(:,:,:,16))
  call check_last_SV_V(l_switch,G1(:,:,:,16),wf(:,1),G1tensor(:,5))
  call loop_ZA_Q(G1(:,:,:,1),wf(:,49),G1(:,:,:,17),gZd)
  call loop_A_Q(G1(:,:,:,17),Q(:,122),ZERO,G2(:,:,:,17))
  call loop_AQ_Z(G2(:,:,:,17),wf(:,-7),G2(:,:,:,18),gZd)
  call check_last_UV_W(l_switch,G2(:,:,:,18),Q(:,250),wf(:,1),Q(:,5),G3tensor(:,6))
  call loop_VV_S(G1(:,:,:,1),wf(:,56),G1(:,:,:,18))
  call check_last_SV_V(l_switch,G1(:,:,:,18),wf(:,1),G1tensor(:,6))
  call loop_VV_S(G1(:,:,:,1),wf(:,100),G1(:,:,:,19))
  call check_last_SV_V(l_switch,G1(:,:,:,19),wf(:,1),G1tensor(:,7))
  call loop_VV_S(G1(:,:,:,1),wf(:,107),G1(:,:,:,20))
  call check_last_SV_V(l_switch,G1(:,:,:,20),wf(:,1),G1tensor(:,8))
  call loop_ZQ_A(G1(:,:,:,1),wf(:,1077),G1(:,:,:,21),gZn)
  call loop_Q_A(G1(:,:,:,21),Q(:,247),ZERO,G2(:,:,:,19))
  call check_last_QA_W(l_switch,G2(:,:,:,19),wf(:,-3),G2tensor(:,12))
  call loop_ZA_Q(G1(:,:,:,1),wf(:,-3),G1(:,:,:,22),gZl)
  call loop_A_Q(G1(:,:,:,22),Q(:,104),ZERO,G2(:,:,:,20))
  call loop_AQ_Z(G2(:,:,:,20),wf(:,98),G2(:,:,:,21),gZl)
  call check_last_UV_W(l_switch,G2(:,:,:,21),Q(:,250),wf(:,1),Q(:,5),G3tensor(:,7))
  call loop_AV_Q(G2(:,:,:,20),wf(:,37),G2(:,:,:,22))
  call loop_A_Q(G2(:,:,:,22),Q(:,253),ZERO,G3(:,:,:,8))
  call check_last_AQ_W(l_switch,G3(:,:,:,8),wf(:,-1),G3tensor(:,8))
  call loop_AZ_Q(G2(:,:,:,20),wf(:,37),G2(:,:,:,23),gZl)
  call loop_A_Q(G2(:,:,:,23),Q(:,253),ZERO,G3(:,:,:,9))
  call check_last_AQ_W(l_switch,G3(:,:,:,9),wf(:,-1),G3tensor(:,9))
  call loop_AV_Q(G2(:,:,:,20),wf(:,46),G2(:,:,:,24))
  call loop_A_Q(G2(:,:,:,24),Q(:,253),ZERO,G3(:,:,:,10))
  call check_last_AQ_W(l_switch,G3(:,:,:,10),wf(:,-1),G3tensor(:,10))
  call loop_AZ_Q(G2(:,:,:,20),wf(:,47),G2(:,:,:,25),gZl)
  call loop_A_Q(G2(:,:,:,25),Q(:,253),ZERO,G3(:,:,:,11))
  call check_last_AQ_W(l_switch,G3(:,:,:,11),wf(:,-1),G3tensor(:,11))
  call loop_AV_Q(G2(:,:,:,20),wf(:,51),G2(:,:,:,26))
  call loop_A_Q(G2(:,:,:,26),Q(:,253),ZERO,G3(:,:,:,12))
  call check_last_AQ_W(l_switch,G3(:,:,:,12),wf(:,-1),G3tensor(:,12))
  call loop_AZ_Q(G2(:,:,:,20),wf(:,52),G2(:,:,:,27),gZl)
  call loop_A_Q(G2(:,:,:,27),Q(:,253),ZERO,G3(:,:,:,13))
  call check_last_AQ_W(l_switch,G3(:,:,:,13),wf(:,-1),G3tensor(:,13))
  call loop_AV_Q(G2(:,:,:,20),wf(:,131),G2(:,:,:,28))
  call loop_A_Q(G2(:,:,:,28),Q(:,253),ZERO,G3(:,:,:,14))
  call check_last_AQ_W(l_switch,G3(:,:,:,14),wf(:,-1),G3tensor(:,14))
  call loop_AZ_Q(G2(:,:,:,20),wf(:,132),G2(:,:,:,29),gZl)
  call loop_A_Q(G2(:,:,:,29),Q(:,253),ZERO,G3(:,:,:,15))
  call check_last_AQ_W(l_switch,G3(:,:,:,15),wf(:,-1),G3tensor(:,15))
  call loop_AZ_Q(G2(:,:,:,20),wf(:,139),G2(:,:,:,30),gZl)
  call loop_A_Q(G2(:,:,:,30),Q(:,253),ZERO,G3(:,:,:,16))
  call check_last_AQ_W(l_switch,G3(:,:,:,16),wf(:,-1),G3tensor(:,16))
  call loop_AQ_W(G2(:,:,:,20),wf(:,-1),G2(:,:,:,31))
  call loop_WA_Q(G2(:,:,:,31),wf(:,138),G2(:,:,:,32))
  call loop_A_Q(G2(:,:,:,32),Q(:,254),ZERO,G3(:,:,:,17))
  call check_last_AQ_W(l_switch,G3(:,:,:,17),wf(:,0),G3tensor(:,17))
  call loop_ZQ_A(G1(:,:,:,1),wf(:,1064),G1(:,:,:,23),gZn)
  call loop_Q_A(G1(:,:,:,23),Q(:,247),ZERO,G2(:,:,:,33))
  call check_last_QA_W(l_switch,G2(:,:,:,33),wf(:,-3),G2tensor(:,13))
  call loop_ZA_Q(G1(:,:,:,1),wf(:,1072),G1(:,:,:,24),gZl)
  call loop_A_Q(G1(:,:,:,24),Q(:,253),ZERO,G2(:,:,:,34))
  call check_last_AQ_W(l_switch,G2(:,:,:,34),wf(:,-1),G2tensor(:,14))
  call loop_UV_W(G1(:,:,:,1),Q(:,96),wf(:,1),Q(:,5),G2(:,:,:,35))
  call loop_WA_Q(G2(:,:,:,35),wf(:,106),G2(:,:,:,36))
  call loop_A_Q(G2(:,:,:,36),Q(:,253),ZERO,G3(:,:,:,18))
  call check_last_AQ_W(l_switch,G3(:,:,:,18),wf(:,-1),G3tensor(:,18))
  call loop_ZA_Q(G1(:,:,:,1),wf(:,1056),G1(:,:,:,25),gZl)
  call loop_A_Q(G1(:,:,:,25),Q(:,253),ZERO,G2(:,:,:,37))
  call check_last_AQ_W(l_switch,G2(:,:,:,37),wf(:,-1),G2tensor(:,15))
  call loop_ZA_Q(G1(:,:,:,1),wf(:,1058),G1(:,:,:,26),gZl)
  call loop_A_Q(G1(:,:,:,26),Q(:,253),ZERO,G2(:,:,:,38))
  call check_last_AQ_W(l_switch,G2(:,:,:,38),wf(:,-1),G2tensor(:,16))
  call loop_ZQ_A(G1(:,:,:,1),wf(:,1559),G1(:,:,:,27),gZn)
  call loop_Q_A(G1(:,:,:,27),Q(:,247),ZERO,G2(:,:,:,39))
  call check_last_QA_W(l_switch,G2(:,:,:,39),wf(:,-3),G2tensor(:,17))
  call loop_ZA_Q(G1(:,:,:,1),wf(:,1561),G1(:,:,:,28),gZl)
  call loop_A_Q(G1(:,:,:,28),Q(:,253),ZERO,G2(:,:,:,40))
  call check_last_AQ_W(l_switch,G2(:,:,:,40),wf(:,-1),G2tensor(:,18))
  call loop_ZA_Q(G1(:,:,:,1),wf(:,1563),G1(:,:,:,29),gZl)
  call loop_A_Q(G1(:,:,:,29),Q(:,253),ZERO,G2(:,:,:,41))
  call check_last_AQ_W(l_switch,G2(:,:,:,41),wf(:,-1),G2tensor(:,19))
  call loop_ZQ_A(G1(:,:,:,1),wf(:,1570),G1(:,:,:,30),gZn)
  call loop_Q_A(G1(:,:,:,30),Q(:,247),ZERO,G2(:,:,:,42))
  call check_last_QA_W(l_switch,G2(:,:,:,42),wf(:,-3),G2tensor(:,20))
  call loop_ZA_Q(G1(:,:,:,1),wf(:,1572),G1(:,:,:,31),gZl)
  call loop_A_Q(G1(:,:,:,31),Q(:,253),ZERO,G2(:,:,:,43))
  call check_last_AQ_W(l_switch,G2(:,:,:,43),wf(:,-1),G2tensor(:,21))
  call loop_ZA_Q(G1(:,:,:,1),wf(:,1574),G1(:,:,:,32),gZl)
  call loop_A_Q(G1(:,:,:,32),Q(:,253),ZERO,G2(:,:,:,44))
  call check_last_AQ_W(l_switch,G2(:,:,:,44),wf(:,-1),G2tensor(:,22))
  call loop_VV_S(G1(:,:,:,1),wf(:,132),G1(:,:,:,33))
  call check_last_SV_V(l_switch,G1(:,:,:,33),wf(:,2),G1tensor(:,9))
  call loop_VV_S(G1(:,:,:,1),wf(:,139),G1(:,:,:,34))
  call check_last_SV_V(l_switch,G1(:,:,:,34),wf(:,2),G1tensor(:,10))
  call loop_ZQ_A(G1(:,:,:,1),wf(:,1221),G1(:,:,:,35),gZn)
  call loop_Q_A(G1(:,:,:,35),Q(:,251),ZERO,G2(:,:,:,45))
  call check_last_QA_W(l_switch,G2(:,:,:,45),wf(:,-2),G2tensor(:,23))
  call loop_ZQ_A(G1(:,:,:,1),wf(:,1206),G1(:,:,:,36),gZn)
  call loop_Q_A(G1(:,:,:,36),Q(:,251),ZERO,G2(:,:,:,46))
  call check_last_QA_W(l_switch,G2(:,:,:,46),wf(:,-2),G2tensor(:,24))
  call loop_ZA_Q(G1(:,:,:,1),wf(:,1214),G1(:,:,:,37),gZl)
  call loop_A_Q(G1(:,:,:,37),Q(:,254),ZERO,G2(:,:,:,47))
  call check_last_AQ_W(l_switch,G2(:,:,:,47),wf(:,0),G2tensor(:,25))
  call loop_ZA_Q(G1(:,:,:,1),wf(:,1198),G1(:,:,:,38),gZl)
  call loop_A_Q(G1(:,:,:,38),Q(:,254),ZERO,G2(:,:,:,48))
  call check_last_AQ_W(l_switch,G2(:,:,:,48),wf(:,0),G2tensor(:,26))
  call loop_ZA_Q(G1(:,:,:,1),wf(:,1200),G1(:,:,:,39),gZl)
  call loop_A_Q(G1(:,:,:,39),Q(:,254),ZERO,G2(:,:,:,49))
  call check_last_AQ_W(l_switch,G2(:,:,:,49),wf(:,0),G2tensor(:,27))
  call loop_ZA_Q(G1(:,:,:,1),wf(:,-2),G1(:,:,:,40),gZl)
  call loop_A_Q(G1(:,:,:,40),Q(:,100),ZERO,G2(:,:,:,50))
  call loop_AV_Q(G2(:,:,:,50),wf(:,42),G2(:,:,:,51))
  call loop_A_Q(G2(:,:,:,51),Q(:,254),ZERO,G3(:,:,:,19))
  call check_last_AQ_W(l_switch,G3(:,:,:,19),wf(:,0),G3tensor(:,19))
  call loop_AZ_Q(G2(:,:,:,50),wf(:,42),G2(:,:,:,52),gZl)
  call loop_A_Q(G2(:,:,:,52),Q(:,254),ZERO,G3(:,:,:,20))
  call check_last_AQ_W(l_switch,G3(:,:,:,20),wf(:,0),G3tensor(:,20))
  call loop_AV_Q(G2(:,:,:,50),wf(:,53),G2(:,:,:,53))
  call loop_A_Q(G2(:,:,:,53),Q(:,254),ZERO,G3(:,:,:,21))
  call check_last_AQ_W(l_switch,G3(:,:,:,21),wf(:,0),G3tensor(:,21))
  call loop_AZ_Q(G2(:,:,:,50),wf(:,54),G2(:,:,:,54),gZl)
  call loop_A_Q(G2(:,:,:,54),Q(:,254),ZERO,G3(:,:,:,22))
  call check_last_AQ_W(l_switch,G3(:,:,:,22),wf(:,0),G3tensor(:,22))
  call loop_AV_Q(G2(:,:,:,50),wf(:,55),G2(:,:,:,55))
  call loop_A_Q(G2(:,:,:,55),Q(:,254),ZERO,G3(:,:,:,23))
  call check_last_AQ_W(l_switch,G3(:,:,:,23),wf(:,0),G3tensor(:,23))
  call loop_AZ_Q(G2(:,:,:,50),wf(:,56),G2(:,:,:,56),gZl)
  call loop_A_Q(G2(:,:,:,56),Q(:,254),ZERO,G3(:,:,:,24))
  call check_last_AQ_W(l_switch,G3(:,:,:,24),wf(:,0),G3tensor(:,24))
  call loop_AV_Q(G2(:,:,:,50),wf(:,99),G2(:,:,:,57))
  call loop_A_Q(G2(:,:,:,57),Q(:,254),ZERO,G3(:,:,:,25))
  call check_last_AQ_W(l_switch,G3(:,:,:,25),wf(:,0),G3tensor(:,25))
  call loop_AZ_Q(G2(:,:,:,50),wf(:,100),G2(:,:,:,58),gZl)
  call loop_A_Q(G2(:,:,:,58),Q(:,254),ZERO,G3(:,:,:,26))
  call check_last_AQ_W(l_switch,G3(:,:,:,26),wf(:,0),G3tensor(:,26))
  call loop_AZ_Q(G2(:,:,:,50),wf(:,107),G2(:,:,:,59),gZl)
  call loop_A_Q(G2(:,:,:,59),Q(:,254),ZERO,G3(:,:,:,27))
  call check_last_AQ_W(l_switch,G3(:,:,:,27),wf(:,0),G3tensor(:,27))
  call loop_ZQ_A(G1(:,:,:,1),wf(:,1818),G1(:,:,:,41),gZn)
  call loop_Q_A(G1(:,:,:,41),Q(:,251),ZERO,G2(:,:,:,60))
  call check_last_QA_W(l_switch,G2(:,:,:,60),wf(:,-2),G2tensor(:,28))
  call loop_ZQ_A(G1(:,:,:,1),wf(:,1821),G1(:,:,:,42),gZn)
  call loop_Q_A(G1(:,:,:,42),Q(:,251),ZERO,G2(:,:,:,61))
  call check_last_QA_W(l_switch,G2(:,:,:,61),wf(:,-2),G2tensor(:,29))
  call loop_ZA_Q(G1(:,:,:,1),wf(:,1824),G1(:,:,:,43),gZl)
  call loop_A_Q(G1(:,:,:,43),Q(:,254),ZERO,G2(:,:,:,62))
  call check_last_AQ_W(l_switch,G2(:,:,:,62),wf(:,0),G2tensor(:,30))
  call loop_ZA_Q(G1(:,:,:,1),wf(:,1826),G1(:,:,:,44),gZl)
  call loop_A_Q(G1(:,:,:,44),Q(:,254),ZERO,G2(:,:,:,63))
  call check_last_AQ_W(l_switch,G2(:,:,:,63),wf(:,0),G2tensor(:,31))
  call loop_ZA_Q(G1(:,:,:,1),wf(:,1833),G1(:,:,:,45),gZl)
  call loop_A_Q(G1(:,:,:,45),Q(:,254),ZERO,G2(:,:,:,64))
  call check_last_AQ_W(l_switch,G2(:,:,:,64),wf(:,0),G2tensor(:,32))
  call loop_ZA_Q(G1(:,:,:,1),wf(:,1835),G1(:,:,:,46),gZl)
  call loop_A_Q(G1(:,:,:,46),Q(:,254),ZERO,G2(:,:,:,65))
  call check_last_AQ_W(l_switch,G2(:,:,:,65),wf(:,0),G2tensor(:,33))
  call loop_ZQ_A(G1(:,:,:,1),wf(:,2069),G1(:,:,:,47),gZn)
  call loop_Q_A(G1(:,:,:,47),Q(:,247),ZERO,G2(:,:,:,66))
  call check_last_QA_W(l_switch,G2(:,:,:,66),wf(:,-3),G2tensor(:,34))
  call loop_ZQ_A(G1(:,:,:,1),wf(:,2071),G1(:,:,:,48),gZn)
  call loop_Q_A(G1(:,:,:,48),Q(:,251),ZERO,G2(:,:,:,67))
  call check_last_QA_W(l_switch,G2(:,:,:,67),wf(:,-2),G2tensor(:,35))
  call loop_ZA_Q(G1(:,:,:,1),wf(:,2073),G1(:,:,:,49),gZl)
  call loop_A_Q(G1(:,:,:,49),Q(:,253),ZERO,G2(:,:,:,68))
  call check_last_AQ_W(l_switch,G2(:,:,:,68),wf(:,-1),G2tensor(:,36))
  call loop_ZQ_A(G1(:,:,:,1),wf(:,2075),G1(:,:,:,50),gZn)
  call loop_Q_A(G1(:,:,:,50),Q(:,247),ZERO,G2(:,:,:,69))
  call check_last_QA_W(l_switch,G2(:,:,:,69),wf(:,-3),G2tensor(:,37))
  call loop_ZA_Q(G1(:,:,:,1),wf(:,2077),G1(:,:,:,51),gZl)
  call loop_A_Q(G1(:,:,:,51),Q(:,253),ZERO,G2(:,:,:,70))
  call check_last_AQ_W(l_switch,G2(:,:,:,70),wf(:,-1),G2tensor(:,38))
  call loop_ZA_Q(G1(:,:,:,1),wf(:,2079),G1(:,:,:,52),gZl)
  call loop_A_Q(G1(:,:,:,52),Q(:,253),ZERO,G2(:,:,:,71))
  call check_last_AQ_W(l_switch,G2(:,:,:,71),wf(:,-1),G2tensor(:,39))
  call loop_ZQ_A(G1(:,:,:,1),wf(:,2098),G1(:,:,:,53),gZn)
  call loop_Q_A(G1(:,:,:,53),Q(:,251),ZERO,G2(:,:,:,72))
  call check_last_QA_W(l_switch,G2(:,:,:,72),wf(:,-2),G2tensor(:,40))
  call loop_ZA_Q(G1(:,:,:,1),wf(:,2104),G1(:,:,:,54),gZl)
  call loop_A_Q(G1(:,:,:,54),Q(:,254),ZERO,G2(:,:,:,73))
  call check_last_AQ_W(l_switch,G2(:,:,:,73),wf(:,0),G2tensor(:,41))
  call loop_ZA_Q(G1(:,:,:,1),wf(:,2108),G1(:,:,:,55),gZl)
  call loop_A_Q(G1(:,:,:,55),Q(:,254),ZERO,G2(:,:,:,74))
  call check_last_AQ_W(l_switch,G2(:,:,:,74),wf(:,0),G2tensor(:,42))
  call loop_ZA_Q(G1(:,:,:,1),wf(:,2110),G1(:,:,:,56),gZl)
  call loop_A_Q(G1(:,:,:,56),Q(:,254),ZERO,G2(:,:,:,75))
  call check_last_AQ_W(l_switch,G2(:,:,:,75),wf(:,0),G2tensor(:,43))
  call loop_ZQ_A(G1(:,:,:,1),wf(:,-1),G1(:,:,:,57),gZn)
  call loop_Q_A(G1(:,:,:,57),Q(:,98),ZERO,G2(:,:,:,76))
  call loop_QA_W(G2(:,:,:,76),wf(:,-3),G2(:,:,:,77))
  call loop_WA_Q(G2(:,:,:,77),wf(:,138),G2(:,:,:,78))
  call loop_A_Q(G2(:,:,:,78),Q(:,254),ZERO,G3(:,:,:,28))
  call check_last_AQ_W(l_switch,G3(:,:,:,28),wf(:,0),G3tensor(:,28))

  end if

  ! add colour interference with born to the sum of coefficient tensors for the proper tensor integral
  Gcoeff = (c(11)*M(2)) * den(2695)
  T2sum(1:15,70) = T2sum(1:15,70) + Gcoeff * G2tensor(:,1)
  Gcoeff = (c(11)*M(2)) * den(2697)
  T2sum(1:15,80) = T2sum(1:15,80) + Gcoeff * G2tensor(:,2)
  Gcoeff = (-(c(9)*M(2))) * den(2698)
  T2sum(1:15,85) = T2sum(1:15,85) + Gcoeff * G2tensor(:,3)
  Gcoeff = (-(c(34)*M(2))) * den(2705)
  T2sum(1:15,119) = T2sum(1:15,119) + Gcoeff * G2tensor(:,4)
  Gcoeff = (c(20)*M(2)) * den(2791)
  T2sum(1:15,80) = T2sum(1:15,80) + Gcoeff * G2tensor(:,5)
  Gcoeff = (c(20)*M(2)) * den(2793)
  T3sum(1:5,248) = T3sum(1:5,248) + Gcoeff * G1tensor(:,1)
  Gcoeff = (c(20)*M(2)) * den(2794)
  T2sum(1:15,70) = T2sum(1:15,70) + Gcoeff * G2tensor(:,6)
  Gcoeff = (c(20)*M(2)) * den(2796)
  T3sum(1:5,255) = T3sum(1:5,255) + Gcoeff * G1tensor(:,2)
  Gcoeff = (-(c(11)*M(2))) * den(2803)
  T4sum(1:70,131) = T4sum(1:70,131) + Gcoeff * G4tensor(:,2)
  Gcoeff = (-(c(81)*M(2))) * den(2803)
  T4sum(1:15,127) = T4sum(1:15,127) + Gcoeff * G2tensor(:,8)
  Gcoeff = (c(24)*M(2)) * den(2803)
  T4sum(1:15,127) = T4sum(1:15,127) + Gcoeff * G2tensor(:,7)
  Gcoeff = (c(147)*M(2)) * den(2803)
  T4sum(1:15,131) = T4sum(1:15,131) + Gcoeff * G2tensor(:,9)
  Gcoeff = (-(c(33)*M(2))) * den(2804)
  T2sum(1:15,502) = T2sum(1:15,502) + Gcoeff * G2tensor(:,10)
  Gcoeff = (c(37)*M(2)) * den(2806)
  T3sum(1:5,248) = T3sum(1:5,248) + Gcoeff * G1tensor(:,3)
  Gcoeff = (-(c(58)*M(2))) * den(2809)
  T3sum(1:35,278) = T3sum(1:35,278) + Gcoeff * G3tensor(:,5)
  Gcoeff = (-(c(33)*M(2))) * den(2810)
  T2sum(1:15,511) = T2sum(1:15,511) + Gcoeff * G2tensor(:,11)
  Gcoeff = (c(37)*M(2)) * den(2812)
  T3sum(1:5,248) = T3sum(1:5,248) + Gcoeff * G1tensor(:,4)
  Gcoeff = (-(c(58)*M(2))) * den(2815)
  T3sum(1:35,306) = T3sum(1:35,306) + Gcoeff * G3tensor(:,1)
  Gcoeff = (c(37)*M(2)) * den(2817)
  T3sum(1:5,255) = T3sum(1:5,255) + Gcoeff * G1tensor(:,5)
  Gcoeff = (-(c(58)*M(2))) * den(2820)
  T3sum(1:35,312) = T3sum(1:35,312) + Gcoeff * G3tensor(:,6)
  Gcoeff = (c(37)*M(2)) * den(2822)
  T3sum(1:5,255) = T3sum(1:5,255) + Gcoeff * G1tensor(:,6)
  Gcoeff = (-(c(58)*M(2))) * den(2825)
  T3sum(1:35,340) = T3sum(1:35,340) + Gcoeff * G3tensor(:,2)
  Gcoeff = (-(c(35)*M(2))) * den(396)
  T4sum(1:70,162) = T4sum(1:70,162) + Gcoeff * G4tensor(:,3)
  Gcoeff = (-(c(58)*M(2))) * den(396)
  T4sum(1:70,204) = T4sum(1:70,204) + Gcoeff * G4tensor(:,1)
  Gcoeff = (c(37)*M(2)) * den(3013)
  T3sum(1:5,255) = T3sum(1:5,255) + Gcoeff * G1tensor(:,7)
  Gcoeff = (c(37)*M(2)) * den(3016)
  T3sum(1:5,255) = T3sum(1:5,255) + Gcoeff * G1tensor(:,8)
  Gcoeff = (-(c(33)*M(2))) * den(3018)
  T2sum(1:15,992) = T2sum(1:15,992) + Gcoeff * G2tensor(:,12)
  Gcoeff = (-(c(58)*M(2))) * den(3021)
  T3sum(1:35,1211) = T3sum(1:35,1211) + Gcoeff * G3tensor(:,7)
  Gcoeff = (-(c(58)*M(2))) * den(3026)
  T2sum(1:15,992) = T2sum(1:15,992) + Gcoeff * G2tensor(:,13)
  Gcoeff = (-(c(33)*M(2))) * den(3028)
  T2sum(1:15,1015) = T2sum(1:15,1015) + Gcoeff * G2tensor(:,14)
  Gcoeff = (-(c(8)*M(2))) * den(3030)
  T3sum(1:35,1238) = T3sum(1:35,1238) + Gcoeff * G3tensor(:,18)
  Gcoeff = (c(100)*M(2)) * den(3034)
  T2sum(1:15,1015) = T2sum(1:15,1015) + Gcoeff * G2tensor(:,15)
  Gcoeff = (-(c(58)*M(2))) * den(3035)
  T2sum(1:15,1015) = T2sum(1:15,1015) + Gcoeff * G2tensor(:,16)
  Gcoeff = (c(100)*M(2)) * den(2080)
  T3sum(1:35,1250) = T3sum(1:35,1250) + Gcoeff * G3tensor(:,8)
  Gcoeff = (-(c(58)*M(2))) * den(2082)
  T3sum(1:35,1250) = T3sum(1:35,1250) + Gcoeff * G3tensor(:,9)
  Gcoeff = (-(c(100)*M(2))) * den(3039)
  T2sum(1:15,992) = T2sum(1:15,992) + Gcoeff * G2tensor(:,17)
  Gcoeff = (-(c(97)*M(2))) * den(3041)
  T2sum(1:15,1015) = T2sum(1:15,1015) + Gcoeff * G2tensor(:,18)
  Gcoeff = (-(c(100)*M(2))) * den(3042)
  T2sum(1:15,1015) = T2sum(1:15,1015) + Gcoeff * G2tensor(:,19)
  Gcoeff = (-(c(97)*M(2))) * den(2093)
  T3sum(1:35,1250) = T3sum(1:35,1250) + Gcoeff * G3tensor(:,10)
  Gcoeff = (-(c(100)*M(2))) * den(2095)
  T3sum(1:35,1250) = T3sum(1:35,1250) + Gcoeff * G3tensor(:,11)
  Gcoeff = (-(c(100)*M(2))) * den(3043)
  T2sum(1:15,992) = T2sum(1:15,992) + Gcoeff * G2tensor(:,20)
  Gcoeff = (c(99)*M(2)) * den(3045)
  T2sum(1:15,1015) = T2sum(1:15,1015) + Gcoeff * G2tensor(:,21)
  Gcoeff = (-(c(100)*M(2))) * den(3046)
  T2sum(1:15,1015) = T2sum(1:15,1015) + Gcoeff * G2tensor(:,22)
  Gcoeff = (c(99)*M(2)) * den(2101)
  T3sum(1:35,1250) = T3sum(1:35,1250) + Gcoeff * G3tensor(:,12)
  Gcoeff = (-(c(100)*M(2))) * den(2103)
  T3sum(1:35,1250) = T3sum(1:35,1250) + Gcoeff * G3tensor(:,13)
  Gcoeff = (c(37)*M(2)) * den(3129)
  T3sum(1:5,248) = T3sum(1:5,248) + Gcoeff * G1tensor(:,9)
  Gcoeff = (c(37)*M(2)) * den(3132)
  T3sum(1:5,248) = T3sum(1:5,248) + Gcoeff * G1tensor(:,10)
  Gcoeff = (-(c(33)*M(2))) * den(3134)
  T2sum(1:15,1280) = T2sum(1:15,1280) + Gcoeff * G2tensor(:,23)
  Gcoeff = (-(c(8)*M(2))) * den(3137)
  T3sum(1:35,1969) = T3sum(1:35,1969) + Gcoeff * G3tensor(:,3)
  Gcoeff = (-(c(58)*M(2))) * den(3142)
  T2sum(1:15,1280) = T2sum(1:15,1280) + Gcoeff * G2tensor(:,24)
  Gcoeff = (-(c(33)*M(2))) * den(3144)
  T2sum(1:15,1303) = T2sum(1:15,1303) + Gcoeff * G2tensor(:,25)
  Gcoeff = (-(c(8)*M(2))) * den(3146)
  T3sum(1:35,1998) = T3sum(1:35,1998) + Gcoeff * G3tensor(:,4)
  Gcoeff = (c(100)*M(2)) * den(3150)
  T2sum(1:15,1303) = T2sum(1:15,1303) + Gcoeff * G2tensor(:,26)
  Gcoeff = (-(c(58)*M(2))) * den(3151)
  T2sum(1:15,1303) = T2sum(1:15,1303) + Gcoeff * G2tensor(:,27)
  Gcoeff = (c(100)*M(2)) * den(2308)
  T3sum(1:35,2010) = T3sum(1:35,2010) + Gcoeff * G3tensor(:,19)
  Gcoeff = (-(c(58)*M(2))) * den(2310)
  T3sum(1:35,2010) = T3sum(1:35,2010) + Gcoeff * G3tensor(:,20)
  Gcoeff = (-(c(100)*M(2))) * den(3160)
  T2sum(1:15,1280) = T2sum(1:15,1280) + Gcoeff * G2tensor(:,28)
  Gcoeff = (-(c(100)*M(2))) * den(3163)
  T2sum(1:15,1280) = T2sum(1:15,1280) + Gcoeff * G2tensor(:,29)
  Gcoeff = (-(c(97)*M(2))) * den(3165)
  T2sum(1:15,1303) = T2sum(1:15,1303) + Gcoeff * G2tensor(:,30)
  Gcoeff = (-(c(100)*M(2))) * den(3166)
  T2sum(1:15,1303) = T2sum(1:15,1303) + Gcoeff * G2tensor(:,31)
  Gcoeff = (-(c(97)*M(2))) * den(2339)
  T3sum(1:35,2010) = T3sum(1:35,2010) + Gcoeff * G3tensor(:,21)
  Gcoeff = (-(c(100)*M(2))) * den(2341)
  T3sum(1:35,2010) = T3sum(1:35,2010) + Gcoeff * G3tensor(:,22)
  Gcoeff = (c(99)*M(2)) * den(3167)
  T2sum(1:15,1303) = T2sum(1:15,1303) + Gcoeff * G2tensor(:,32)
  Gcoeff = (-(c(100)*M(2))) * den(3168)
  T2sum(1:15,1303) = T2sum(1:15,1303) + Gcoeff * G2tensor(:,33)
  Gcoeff = (c(99)*M(2)) * den(2346)
  T3sum(1:35,2010) = T3sum(1:35,2010) + Gcoeff * G3tensor(:,23)
  Gcoeff = (-(c(100)*M(2))) * den(2348)
  T3sum(1:35,2010) = T3sum(1:35,2010) + Gcoeff * G3tensor(:,24)
  Gcoeff = (-(c(100)*M(2))) * den(3238)
  T2sum(1:15,992) = T2sum(1:15,992) + Gcoeff * G2tensor(:,34)
  Gcoeff = (-(c(100)*M(2))) * den(3240)
  T2sum(1:15,1280) = T2sum(1:15,1280) + Gcoeff * G2tensor(:,35)
  Gcoeff = (-(c(100)*M(2))) * den(3242)
  T2sum(1:15,1015) = T2sum(1:15,1015) + Gcoeff * G2tensor(:,36)
  Gcoeff = (-(c(100)*M(2))) * den(3244)
  T2sum(1:15,992) = T2sum(1:15,992) + Gcoeff * G2tensor(:,37)
  Gcoeff = (-(c(100)*M(2))) * den(3245)
  T2sum(1:15,1015) = T2sum(1:15,1015) + Gcoeff * G2tensor(:,38)
  Gcoeff = (-(c(100)*M(2))) * den(3246)
  T2sum(1:15,1015) = T2sum(1:15,1015) + Gcoeff * G2tensor(:,39)
  Gcoeff = (-(c(100)*M(2))) * den(2568)
  T3sum(1:35,1250) = T3sum(1:35,1250) + Gcoeff * G3tensor(:,14)
  Gcoeff = (-(c(100)*M(2))) * den(2570)
  T3sum(1:35,1250) = T3sum(1:35,1250) + Gcoeff * G3tensor(:,15)
  Gcoeff = (-(c(100)*M(2))) * den(2579)
  T3sum(1:35,1250) = T3sum(1:35,1250) + Gcoeff * G3tensor(:,16)
  Gcoeff = (-(c(100)*M(2))) * den(3250)
  T2sum(1:15,1280) = T2sum(1:15,1280) + Gcoeff * G2tensor(:,40)
  Gcoeff = (-(c(100)*M(2))) * den(3258)
  T2sum(1:15,1303) = T2sum(1:15,1303) + Gcoeff * G2tensor(:,41)
  Gcoeff = (-(c(100)*M(2))) * den(3260)
  T2sum(1:15,1303) = T2sum(1:15,1303) + Gcoeff * G2tensor(:,42)
  Gcoeff = (-(c(100)*M(2))) * den(3261)
  T2sum(1:15,1303) = T2sum(1:15,1303) + Gcoeff * G2tensor(:,43)
  Gcoeff = (-(c(100)*M(2))) * den(2593)
  T3sum(1:35,2010) = T3sum(1:35,2010) + Gcoeff * G3tensor(:,25)
  Gcoeff = (-(c(100)*M(2))) * den(2595)
  T3sum(1:35,2010) = T3sum(1:35,2010) + Gcoeff * G3tensor(:,26)
  Gcoeff = (-(c(100)*M(2))) * den(2603)
  T3sum(1:35,2010) = T3sum(1:35,2010) + Gcoeff * G3tensor(:,27)
  Gcoeff = (-(c(33)*M(2))) * den(3269)
  T3sum(1:35,2873) = T3sum(1:35,2873) + Gcoeff * G3tensor(:,17)
  Gcoeff = (-(c(33)*M(2))) * den(3269)
  T3sum(1:35,2875) = T3sum(1:35,2875) + Gcoeff * G3tensor(:,28)

#ifdef LOOPSQUARED
#ifndef PRECISION_dp
  call gtdealloc()
#endif
#endif

end subroutine vamp_15

#ifdef LOOPSQUARED
subroutine gtdealloc()
  implicit none

end subroutine gtdealloc
#endif

end module ol_vamp_15_ppllnnjj_vbs_nenmexmxuxuxdd_2_/**/REALKIND
